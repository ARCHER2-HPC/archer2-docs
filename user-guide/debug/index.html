
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../analysis/">
      
      
        <link rel="next" href="../profile/">
      
      <link rel="icon" href="../../favicon.ico">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.15">
    
    
      
        <title>Debugging - ARCHER2 User Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/archer2.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-XVNML97F1T"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-XVNML97F1T",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-XVNML97F1T",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#debugging" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="ARCHER2 User Documentation" class="md-header__button md-logo" aria-label="ARCHER2 User Documentation" data-md-component="logo">
      
  <img src="../../images/archer2_white_transparent.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ARCHER2 User Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Debugging
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ARCHER2-HPC/archer2-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    ARCHER2-HPC/archer2-docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ARCHER2 User Documentation" class="md-nav__button md-logo" aria-label="ARCHER2 User Documentation" data-md-component="logo">
      
  <img src="../../images/archer2_white_transparent.png" alt="logo">

    </a>
    ARCHER2 User Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ARCHER2-HPC/archer2-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    ARCHER2-HPC/archer2-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Documentation overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Quickstart
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Quickstart
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quick-start/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quick-start/quickstart-users/" class="md-nav__link">
        Quickstart for users
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quick-start/quickstart-developers/" class="md-nav__link">
        Quickstart for developers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quick-start/quickstart-next-steps/" class="md-nav__link">
        Quickstart next steps
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../known-issues/" class="md-nav__link">
        ARCHER2 Known Issues
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          ARCHER2 Frequently Asked Questions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          ARCHER2 Frequently Asked Questions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        General FAQ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/upgrade-2023/" class="md-nav__link">
        ARCHER2 Upgrade 2023
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          User and Best Practice Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          User and Best Practice Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hardware/" class="md-nav__link">
        Hardware
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../connecting/" class="md-nav__link">
        Connecting to ARCHER2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data/" class="md-nav__link">
        Data management and transfer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sw-environment/" class="md-nav__link">
        Software environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../scheduler/" class="md-nav__link">
        Running jobs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../io/" class="md-nav__link">
        I/O and file systems
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dev-environment/" class="md-nav__link">
        Application development environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../containers/" class="md-nav__link">
        Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python/" class="md-nav__link">
        Using Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../analysis/" class="md-nav__link">
        Data analysis
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Debugging
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Debugging
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#arm-forge" class="md-nav__link">
    Arm Forge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gdb4hpc" class="md-nav__link">
    gdb4hpc
  </a>
  
    <nav class="md-nav" aria-label="gdb4hpc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#launching-through-gdb4hpc" class="md-nav__link">
    Launching through gdb4hpc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attaching-with-gdb4hpc" class="md-nav__link">
    Attaching with gdb4hpc
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#valgrind4hpc" class="md-nav__link">
    valgrind4hpc
  </a>
  
    <nav class="md-nav" aria-label="valgrind4hpc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-valgrind-with-serial-programs" class="md-nav__link">
    Using Valgrind with serial programs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-valgrind4hpc-with-parallel-programs" class="md-nav__link">
    Using Valgrind4hpc with parallel programs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stat" class="md-nav__link">
    STAT
  </a>
  
    <nav class="md-nav" aria-label="STAT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-stat-on-archer2" class="md-nav__link">
    Using STAT on ARCHER2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#atp" class="md-nav__link">
    ATP
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../profile/" class="md-nav__link">
        Profiling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tuning/" class="md-nav__link">
        Performance tuning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../energy/" class="md-nav__link">
        Energy use
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Research Software
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Research Software
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/casino/" class="md-nav__link">
        CASINO
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/castep/" class="md-nav__link">
        CASTEP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/cesm/" class="md-nav__link">
        CESM2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/chemshell/" class="md-nav__link">
        Chemshell
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/code-saturne/" class="md-nav__link">
        Code_Saturne
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/cp2k/" class="md-nav__link">
        CP2K
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/crystal/" class="md-nav__link">
        CRYSTAL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/fhi-aims/" class="md-nav__link">
        FHI-aims
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/gromacs/" class="md-nav__link">
        GROMACS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/lammps/" class="md-nav__link">
        LAMMPS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/mitgcm/" class="md-nav__link">
        MITgcm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/mo-unified-model/" class="md-nav__link">
        Met Office Unified Model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/namd/" class="md-nav__link">
        NAMD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/nektarplusplus/" class="md-nav__link">
        Nektar++
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/nemo/" class="md-nav__link">
        NEMO
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/nwchem/" class="md-nav__link">
        NWChem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/onetep/" class="md-nav__link">
        ONETEP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/openfoam/" class="md-nav__link">
        OpenFOAM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/orca/" class="md-nav__link">
        ORCA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/qe/" class="md-nav__link">
        Quantum Espresso
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../research-software/vasp/" class="md-nav__link">
        VASP
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Software Libraries
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Software Libraries
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software-libraries/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software-libraries/libsci/" class="md-nav__link">
        HPE Cray LibSci: BLAS, LAPACK, ScaLAPACK
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software-libraries/fftw/" class="md-nav__link">
        FFTW
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software-libraries/hdf5/" class="md-nav__link">
        HDF5
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software-libraries/netcdf/" class="md-nav__link">
        NetCDF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software-libraries/adios/" class="md-nav__link">
        ADIOS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software-libraries/aocl/" class="md-nav__link">
        AOCL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software-libraries/arpack/" class="md-nav__link">
        ARPACK
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software-libraries/boost/" class="md-nav__link">
        Boost
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software-libraries/eigen/" class="md-nav__link">
        Eigen
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software-libraries/glm/" class="md-nav__link">
        GLM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software-libraries/hypre/" class="md-nav__link">
        HYPRE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software-libraries/matio/" class="md-nav__link">
        Matio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software-libraries/mkl/" class="md-nav__link">
        Intel MKL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software-libraries/mumps/" class="md-nav__link">
        MUMPS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software-libraries/petsc/" class="md-nav__link">
        PETSc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software-libraries/metis/" class="md-nav__link">
        Metis/Parmetis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software-libraries/scotch/" class="md-nav__link">
        Scotch/PT-Scotch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software-libraries/slepc/" class="md-nav__link">
        SLEPc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software-libraries/superlu/" class="md-nav__link">
        SuperLU/SuperLU_DIST
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software-libraries/trilinos/" class="md-nav__link">
        Trilinos
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          Data Analysis and Tools
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Data Analysis and Tools
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data-tools/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data-tools/amd-uprof/" class="md-nav__link">
        AMD uProf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data-tools/arm-forge/" class="md-nav__link">
        Arm Forge
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data-tools/julia/" class="md-nav__link">
        Julia
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data-tools/paraview/" class="md-nav__link">
        ParaView
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data-tools/cray-r/" class="md-nav__link">
        R
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data-tools/visidata/" class="md-nav__link">
        VisiData
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../essentials/" class="md-nav__link">
        Essential Skills
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../publish/" class="md-nav__link">
        ARCHER2 and Publications
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#arm-forge" class="md-nav__link">
    Arm Forge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gdb4hpc" class="md-nav__link">
    gdb4hpc
  </a>
  
    <nav class="md-nav" aria-label="gdb4hpc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#launching-through-gdb4hpc" class="md-nav__link">
    Launching through gdb4hpc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attaching-with-gdb4hpc" class="md-nav__link">
    Attaching with gdb4hpc
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#valgrind4hpc" class="md-nav__link">
    valgrind4hpc
  </a>
  
    <nav class="md-nav" aria-label="valgrind4hpc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-valgrind-with-serial-programs" class="md-nav__link">
    Using Valgrind with serial programs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-valgrind4hpc-with-parallel-programs" class="md-nav__link">
    Using Valgrind4hpc with parallel programs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stat" class="md-nav__link">
    STAT
  </a>
  
    <nav class="md-nav" aria-label="STAT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-stat-on-archer2" class="md-nav__link">
    Using STAT on ARCHER2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#atp" class="md-nav__link">
    ATP
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="debugging">Debugging</h1>
<p>The following debugging tools are available on ARCHER2:</p>
<ul>
<li><a href="../../data-tools/arm-forge/">Arm Forge (DDT)</a> is an easy-to-use graphical
    interface for source-level debugging of compiled C/C++ or Fortran codes.
    It can also be used for non-interactive debugging, and there
    is also some limited support for python debugging.</li>
<li><a href="#gdb4hpc">gdb4hpc</a> is a command-line debugging tool provided by
    HPE Cray. It works similarly to
    <a href="https://www.gnu.org/software/gdb/">gdb</a>, but allows the user to
    debug multiple parallel processes without multiple windows. gdb4hpc
    can be used to investigate deadlocked code, segfaults, and other
    errors for C/C++ and Fortran code. Users can single-step code and
    focus on specific processes groups to help identify unexpected code
    behavior. (text from
    <a href="https://www.alcf.anl.gov/support-center/theta/gdb">ALCF</a>).</li>
<li><a href="#valgrind4hpc">valgrind4hpc</a> is a parallel memory debugging tool
    that aids in detection of memory leaks and errors in parallel
    applications. It aggregates like errors across processes and threads
    to simply debugging of parallel applications.</li>
<li><a href="#stat">STAT</a> generate merged stack traces for parallel applications.
    Also has visualisation tools.</li>
<li><a href="#atp">ATP</a> provides scalable core file and backtrace analysis when parallel
    programs crash.</li>
<li>CCDB Cray Comparative Debugger. Compare two versions of code
    side-by-side to analyse differences. (Not currently described in this
    documentation.)</li>
</ul>
<h2 id="arm-forge">Arm Forge</h2>
<p>The Arm Forge tool provides the DDT parallel debugger. See:</p>
<ul>
<li><a href="../../data-tools/arm-forge/">ARCHER2 Arm Forge documentation</a></li>
</ul>
<h2 id="gdb4hpc">gdb4hpc</h2>
<p>The GNU Debugger for HPC (gdb4hpc) is a GDB-based debugger used to debug
applications compiled with CCE, PGI, GNU, and Intel Fortran, C and C++
compilers. It allows programmers to either launch an application within
it or to attach to an already-running application. Attaching to an
already-running and hanging application is a quick way of understanding
why the application is hanging, whereas launching an application through
gdb4hpc will allow you to see your application running step-by-step,
output the values of variables, and check whether the application runs
as expected.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For your executable to be compatible with gdb4hpc, it will need to be
coded with MPI. You will also need to compile your code with the
debugging flag <code>-g</code> (e.g. <code>cc -g my_program.c -o my_exe</code>).</p>
</div>
<h3 id="launching-through-gdb4hpc">Launching through gdb4hpc</h3>
<p>Launch <code>gdb4hpc</code>:</p>
<pre><code>module load gdb4hpc
gdb4hpc
</code></pre>
<p>You will get some information about this version of the program and,
eventually, you will get a command prompt:</p>
<pre><code>gdb4hpc 4.5 - Cray Line Mode Parallel Debugger
With Cray Comparative Debugging Technology.
Copyright 2007-2019 Cray Inc. All Rights Reserved.
Copyright 1996-2016 University of Queensland. All Rights Reserved.
Type "help" for a list of commands.
Type "help &lt;cmd&gt;" for detailed help about a command.
dbg all&gt;
</code></pre>
<p>We will use <code>launch</code> to begin a multi-process application within
gdb4hpc. Consider that we are wanting to test an application called
<code>my_exe</code>, and that we want this to be launched across all 256 processes
in two nodes. We would launch this in gdb4hpc by
    running:</p>
<pre><code>dbg all&gt; launch --launcher-args="--account=[budget code] --partition=standard --qos=standard --nodes=2 --ntasks-per-node=128 --cpus-per-task=1 --exclusive --export=ALL" $my_prog{256} ./my_ex
</code></pre>
<p>Make sure to replace the <code>--account</code> input to your budget code (<em>e.g.</em>
if you are using budget t01, that part should look like
<code>--account=t01</code>).</p>
<p>The default launcher is <code>srun</code> and the <code>--launcher-args="..."</code> allows
you to set launcher flags for <code>srun</code>. The variable <code>$my_prog</code> is a dummy
name for the program being launched and you could use whatever name you
want for it -- this will be the name of the <code>srun</code> job that will be run.
The number in the brackets <code>{256}</code> is the number of processes over which
the program will be executed, it's 256 here, but you could use any
number. You should try to run this on as few processors as possible --
the more you use, the longer it will take for gdb4hpc to load the
program.</p>
<p>Once the program is launched, gdb4hpc will load up the program and begin
to run it. You will get output to screen something that looks like:</p>
<pre><code>Starting application, please wait...
Creating MRNet communication network...
Waiting for debug servers to attach to MRNet communications network...
Timeout in 400 seconds. Please wait for the attach to complete.
Number of dbgsrvs connected: [0];  Timeout Counter: [1]
Number of dbgsrvs connected: [0];  Timeout Counter: [2]
Number of dbgsrvs connected: [0];  Timeout Counter: [3]
Number of dbgsrvs connected: [1];  Timeout Counter: [0]
Number of dbgsrvs connected: [1];  Timeout Counter: [1]
Number of dbgsrvs connected: [2];  Timeout Counter: [0]
Finalizing setup...
Launch complete.
my_prog{0..255}: Initial breakpoint, main at /PATH/TO/my_program.c:34
</code></pre>
<p>The line number at which the initial breakpoint is made (in the above
example, line 34) corresponds to the line number at which MPI is
initialised. You will not be able to see any parts of the code outside
of the MPI region of a code with gdb4hpc.</p>
<p>Once the code is loaded, you can use various commands to move through
your code. The following lists and describes some of the most useful
ones:</p>
<ul>
<li><code>help</code> -- Lists all gdb4hpc commands. You can run <code>help
     COMMAND_NAME</code> to learn more about a specific command (<em>e.g.</em> <code>help
     launch</code> will tell you about the launch command</li>
<li><code>list</code> -- Will show the current line of code and the 9 lines
     following. Repeated use of <code>list</code> will move you down the code in
     ten-line chunks.</li>
<li><code>next</code> -- Will jump to the next step in the program for each
     process and output which line of code each process is one. It will
     not enter subroutines. !!! note that there is no reverse-step in
     gdb4hpc.</li>
<li><code>step</code> -- Like <code>next</code>, but this will step into subroutines.</li>
<li><code>up</code> -- Go up one level in the program (<em>e.g.</em> from a subroutine
     back to main).</li>
<li><code>print var</code> -- Prints the value of variable <code>var</code> at this point in
     the code.</li>
<li><code>watch var</code> -- Like print, but will print whenever a variable
     changes value.</li>
<li><code>quit</code> -- Exits gdb4hpc.</li>
</ul>
<p>Remember to exit the interactive session once you are done debugging.</p>
<h3 id="attaching-with-gdb4hpc">Attaching with gdb4hpc</h3>
<p>Attaching to a hanging job using gdb4hpc is a great way of seeing which
state each processor is in. However, this does not produce the most
visually appealing results. For a more easy-to-read program, please take
a look at the STAT tool.</p>
<p>In your interactive session, launch your executable as a background task
(by adding an <code>&amp;</code> at the end of the command). For example, if you are
running an executable called <code>my_exe</code> using 256 processes, you would
run:</p>
<pre><code>srun -n 256 --nodes=2 --ntasks-per-node=128 --cpus-per-task=1 --time=01:00:00 --export=ALL \
            --account=[budget code] --partition=standard --qos=standard ./my_exe &amp;
</code></pre>
<p>Make sure to replace the <code>--account</code> input to your budget code (<em>e.g.</em>
if you are using budget t01, that part should look like
<code>--account=t01</code>).</p>
<p>You will need to get the full job ID of the job you have just launched.
To do this, run:</p>
<pre><code>squeue -u $USER
</code></pre>
<p>and find the job ID associated with this interactive session -- this
will be the one with the jobname <code>bash</code>. In this
    example:</p>
<pre><code>JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
1050     workq my_mpi_j   jsindt  R       0:16      1 nid000001
1051     workq     bash   jsindt  R       0:12      1 nid000002
</code></pre>
<p>the appropriate job id is 1051. Next, you will need to run <code>sstat</code> on
this job id:</p>
<pre><code>sstat 1051
</code></pre>
<p>This will output a large amount of information about this specific job.
We are looking for the first number of this output, which should look
like <code>JOB_ID.##</code> -- the number after the job ID is the number of slurm
tasks performed in this interactive session. For our example (where
<code>srun</code> is the first slurm task performed), the number is 1051.0.</p>
<p>Launch <code>gdb4hpc</code>:</p>
<pre><code>module load gdb4hpc
gdb4hpc
</code></pre>
<p>You will get some information about this version of the program and,
eventually, you will get a command prompt:</p>
<pre><code>gdb4hpc 4.5 - Cray Line Mode Parallel Debugger
With Cray Comparative Debugging Technology.
Copyright 2007-2019 Cray Inc. All Rights Reserved.
Copyright 1996-2016 University of Queensland. All Rights Reserved.
Type "help" for a list of commands.
Type "help &lt;cmd&gt;" for detailed help about a command.
dbg all&gt;
</code></pre>
<p>We will be using the <code>attach</code> command to attach to our program that
hangs. This is done by writing:</p>
<pre><code>dbg all&gt; attach $my_prog JOB_ID.##
</code></pre>
<p>where <code>JOB_ID.##</code> is the full job ID found using <code>sstat</code> (in our
example, this would be 1051.0). The name <code>$my_prog</code> is a dummy-name --
it could be whatever name you like.</p>
<p>As it is attaching, gdb4hpc will output text to screen that looks like:</p>
<pre><code>Attaching to application, please wait...
Creating MRNet communication network...
Waiting for debug servers to attach to MRNet communications network...
Timeout in 400 seconds. Please wait for the attach to complete.
Number of dbgsrvs connected: [0];  Timeout Counter: [1]

...

Finalizing setup...
Attach complete.
Current rank location:
</code></pre>
<p>After this, you will get an output that, among other things, tells you
which line of your code each process is on, and what each process is
doing. This can be helpful to see where the hang-up is.</p>
<p>If you accidentally attached to the wrong job, you can detach by
running:</p>
<pre><code>dbg all&gt; release $my_prog
</code></pre>
<p>and re-attach with the correct job ID. You will need to change your
dummy name from <code>$my_prog</code> to something else.</p>
<p>When you are finished using <code>gbd4hpc</code>, simply run:</p>
<pre><code>dbg all&gt; quit
</code></pre>
<p>Do not forget to exit your interactive session.</p>
<h2 id="valgrind4hpc">valgrind4hpc</h2>
<p>valgrind4hpc is a Valgrind-based debugging tool to aid in the detection
of memory leaks and errors in parallel applications. Valgrind4hpc
aggregates any duplicate messages across ranks to help provide an
understandable picture of program behavior. Valgrind4hpc manages
starting and redirecting output from many copies of Valgrind, as well as
recombining and filtering Valgrind messages. If your program can be
debugged with Valgrind, it can be debugged with valgrind4hpc.</p>
<p>The valgrind4hpc module enables the use of standard valgrind as well as
the valgrind4hpc version more suitable to parallel programs.</p>
<h3 id="using-valgrind-with-serial-programs">Using Valgrind with serial programs</h3>
<p>Launch <code>valgrind4hpc</code>:</p>
<pre><code>module load valgrind4hpc
</code></pre>
<p>Next, run your executable through valgrind:</p>
<pre><code>valgrind --tool=memcheck --leak-check=yes my_executable
</code></pre>
<p>The log outputs to screen. The <code>ERROR SUMMARY</code> will tell you whether,
and how many, memory errors there
are in your program. Furthermore, if you compile your code using the <code>-g</code>
debugging flag (<em>e.g.</em> <code>gcc -g my_program.c -o my_executable.c</code>), the log
will point out the code lines where the error occurs.</p>
<p>Valgrind also includes a tool called Massif that can be used to give
insight into the memory usage of your program. It takes regular
snapshots and outputs this data into a single file, which can be
visualised to show the total amount of memory used as a function of
time. This shows when peaks and bottlenecks occur and allows you to
identify which data structures in your code are responsible for the
largest memory usage of your program.</p>
<p>Documentation explaining how to use Massif is available at the <a href="https://www.valgrind.org/docs/manual/ms-manual.html">official
Massif manual</a>. In
short, you should run your executable as follows:</p>
<pre><code>valgrind --tool=massif my_executable
</code></pre>
<p>The memory profiling data will be output into a file called
<code>massif.out.pid</code>, where pid is the runtime process ID of your program. A
custom filename can be chosen using the <code>--massif-out-file option</code>, as
follows:</p>
<pre><code>valgrind --tool=massif --massif-out-file=optional_filename.out my_executable
</code></pre>
<p>The output file contains raw profiling statistics. To view a summary
including a graphical plot of memory usage over time, use the <code>ms_print</code>
command as follows:</p>
<pre><code>ms_print massif.out.12345
</code></pre>
<p>or, to save to a file:</p>
<pre><code>ms_print massif.out.12345 &gt; massif.analysis.12345
</code></pre>
<p>This will show total memory usage over time as well as a breakdown of
the top data structures contributing to memory usage at each snapshot
where there has been a significant allocation or deallocation of memory.</p>
<h3 id="using-valgrind4hpc-with-parallel-programs">Using Valgrind4hpc with parallel programs</h3>
<p>First, load <code>valgrind4hpc</code>:</p>
<pre><code>module load valgrind4hpc
</code></pre>
<p>To run valgrind4hpc, first reserve the resources you will use with <code>salloc</code>. 
The following reservation request is for 2 nodes (256 physical cores) for 20 
minutes on the short queue:</p>
<pre><code>auser@uan01:&gt; salloc --nodes=2 --ntasks-per-node=128 --cpus-per-task=1 \
              --time=00:20:00 --partition=standard --qos=short \
              --hint=nomultithread \
              --distribution=block:block --account=[budget code]
</code></pre>
<p>Once your allocation is ready, Use valgrind4hpc to run and profile your 
executable. To test an executable called <code>my_executable</code> that requires two 
arguments <code>arg1</code> and <code>arg2</code> on 2 nodes and 256 processes, run:</p>
<pre><code>valgrind4hpc --tool=memcheck --num-ranks=256 my_executable -- arg1 arg2
</code></pre>
<p>In particular, note the <code>--</code> separating the executable from the
arguments (this is not necessary if your executable takes no arguments).</p>
<!---
Valgrind4hpc will launch an srun job to run the executable while it
profiles. To test an executable called `my_executable` that requires two
arguments `arg1` and `arg2` on two nodes and 256 processes, run:

    valgrind4hpc --tool=memcheck --num-ranks=256 --launcher-args="--account=[budget code] --nodes=2 \
                 --partition=standard --qos=standard --export=ALL -ntasks-per-node=128 --cpus-per-task=1" \
                 my_executable -- arg1 arg2

In particular, note the `--` separating the executable from the
arguments (this is not necessary if your executable takes no arguments).
The `--launcher-args="arguments"` allow you to set launcher flags for
`srun`.
--->

<p>Valgrind4hpc only supports certain tools found in valgrind. These are:
memcheck, helgrind, exp-sgcheck, or drd. The
<code>--valgrind-args="arguments"</code> allows users to use valgrind options not
supported in valgrind4hpc (<em>e.g.</em> <code>--leak-check</code>) -- note, however, that
some of these options might interfere with valgrind4hpc.</p>
<p>More information on valgrind4hpc can be found in the manual
(<code>man valgrind4hpc</code>).</p>
<h2 id="stat">STAT</h2>
<p>The Stack Trace Analysis Tool (STAT) is a cross-platform debugging tool
from the University of Wisconsin-Madison. ATP is based on the same
technology as STAT, both are designed to gather and merge stack traces
from a running application's parallel processes. The STAT tool can be
useful when application seems to be deadlocked or stuck, i.e. they don't
crash but they don't progress as expected, and it has been designed to
scale to a very large number of processes. Full information on STAT,
including use cases, is available at the <a href="https://hpc.llnl.gov/software/development-environment-software/stat-stack-trace-analysis-tool">STAT
website</a>.</p>
<p>STAT will attach to a running program and query that program to find out
where all the processes in that program currently are. It will then
process that data and produce a graph displaying the unique process
locations (i.e. where all the processes in the running program currently
are). To make this easily understandable it collates together all
processes that are in the same place providing only unique program
locations for display.</p>
<h3 id="using-stat-on-archer2">Using STAT on ARCHER2</h3>
<p>On the login node, load the <code>cray-stat</code> module:</p>
<pre><code>module load cray-stat
</code></pre>
<p>Then, launch your job using <code>srun</code> as a background task (by adding an
<code>&amp;</code> at the end of the command). For example, if you are running an
executable called <code>my_exe</code> using 256 processes, you would
    run:</p>
<pre><code>srun -n 256 --nodes=2 --ntasks-per-node=128 --cpus-per-task=1 --time=01:00:00  --export=ALL\
            --account=[budget code] --partition=standard --qos=standard./my_exe &amp;
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This example has set the job time limit to 1 hour -- if you
need longer, change the <code>--time</code> command.</p>
</div>
<p>You will need the Program ID (PID) of the job you have just launched --
the PID is printed to screen upon launch, or you can get it by running:</p>
<pre><code>ps -u $USER
</code></pre>
<p>This will present you with a set of text that looks like this:</p>
<pre><code>PID TTY          TIME CMD
154296 ?     00:00:00 systemd
154297 ?     00:00:00 (sd-pam)
154302 ?     00:00:00 sshd
154303 pts/8 00:00:00 bash
157150 pts/8 00:00:00 salloc
157152 pts/8 00:00:00 bash
157183 pts/8 00:00:00 srun
157185 pts/8 00:00:00 srun
157191 pts/8 00:00:00 ps
</code></pre>
<p>Once your application has reached the point where it hangs, issue the
following command (replacing PID with the ID of the <strong>first</strong> srun task
-- in the above example, I would replace PID with 157183):</p>
<pre><code>stat-cl -i PID
</code></pre>
<p>You will get an output that looks like this:</p>
<pre><code>STAT started at 2020-07-22-13:31:35
Attaching to job launcher (null):157565 and launching tool daemons...
Tool daemons launched and connected!
Attaching to application...
Attached!
Application already paused... ignoring request to pause
Sampling traces...
Traces sampled!
Resuming the application...
Resumed!
Pausing the application...
Paused!

...

Detaching from application...
Detached!

Results written to $PATH_TO_RUN_DIRECTORY/stat_results/my_exe.0000
</code></pre>
<p>Once STAT is finished, you can kill the srun job using <code>scancel</code>
(replacing JID with the job ID of the job you just launched):</p>
<pre><code>scancel JID
</code></pre>
<p>You can view the results that STAT has produced using the following
command (note that "my_exe" will need to be replaced with the name
of the executable you  ran):</p>
<pre><code>stat-view stat_results/my_exe.0000/00_my_exe.0000.3D.dot
</code></pre>
<p>This produces a graph displaying all the different places within the program that the parallel processes were when you queried them.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To see the graph, you will need to have exported your X display when logging in.</p>
</div>
<p>Larger jobs may spend significant time queueing, requiring
submission as a batch job. In this case the above can be adapted for
batch submission as follows:</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash --login</span>

<span class="kp">#SBATCH --job-name=test_job</span>
<span class="kp">#SBATCH --nodes=1</span>
<span class="kp">#SBATCH --ntasks-per-node=128</span>
<span class="kp">#SBATCH --cpus-per-task=1</span>
<span class="kp">#SBATCH --time=2:0:0</span>

<span class="c1"># Replace [budget code] below with your project code (e.g. t01)</span>
<span class="kp">#SBATCH --account=[budget code]</span>
<span class="kp">#SBATCH --partition=standard</span>
<span class="kp">#SBATCH --qos=standard</span>

<span class="c1"># Load additional modules</span>
module<span class="w"> </span>load<span class="w"> </span>cray-stat

<span class="nb">export</span><span class="w"> </span><span class="nv">OMP_NUM_THREADS</span><span class="o">=</span><span class="m">1</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">SRUN_CPUS_PER_TASK</span><span class="o">=</span><span class="nv">$SLURM_CPUS_PER_TASK</span>

<span class="c1"># Launch job in background</span>
<span class="nb">srun</span><span class="w"> </span>--hint<span class="o">=</span>nomultithread<span class="w"> </span>--distribution<span class="o">=</span>block:block<span class="w"> </span>./my_exe<span class="w"> </span><span class="p">&amp;</span>

sleep<span class="w"> </span><span class="m">3600</span><span class="w"> </span><span class="c1"># Wait a sufficient time for job to hang, e.g. 1 hour</span>

<span class="c1"># Find PID and run STAT</span>
<span class="nv">pid</span><span class="o">=</span><span class="k">$(</span>ps<span class="w"> </span>-u<span class="w"> </span><span class="si">${</span><span class="nv">USER</span><span class="si">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="se">\ </span><span class="w"> </span><span class="c1"># Get all USER PIDs</span>
<span class="w">        </span>grep<span class="w"> </span><span class="nb">srun</span><span class="w">     </span><span class="p">|</span><span class="w"> </span><span class="se">\ </span><span class="w"> </span><span class="c1"># Find all the sruns</span>
<span class="w">        </span>head<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w">     </span><span class="p">|</span><span class="w"> </span><span class="se">\ </span><span class="w"> </span><span class="c1"># We want the first one</span>
<span class="w">        </span>awk<span class="w"> </span><span class="s1">&#39;{print $1;}&#39;</span><span class="k">)</span><span class="w"> </span><span class="c1"># The PID is the first &quot;word&quot; in the line</span>
stat-cl<span class="w"> </span>-i<span class="w"> </span><span class="nv">$pid</span>
</code></pre></div>
<p>If the job is hanging it will continue to run until the wall clock
exceeds the requested time.</p>
<h2 id="atp">ATP</h2>
<p>To enable ATP you should load the atp module and set the <code>ATP_ENABLED</code>
environment variable to 1 on the login node:</p>
<pre><code>module load atp
export ATP_ENABLED=1
</code></pre>
<p>Then, launch your job using <code>srun</code> as a background task (by adding an
<code>&amp;</code> at the end of the command). For example, if you are running an
executable called <code>my_exe</code> using 256 processes, you would
    run:</p>
<pre><code>srun -n=256 --nodes=2 --ntasks-per-node=128 --cpus-per-task=1 --time=01:00:00 --export=ALL \
            --account=[budget code] --partition=standard --qos=standard ./my_exe &amp;
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This example has set the job time limit to 1 hour -- if you
need longer, change the <code>--time</code> command.</p>
</div>
<p>Once the job has finished running, load the <code>stat</code> module to view the
results:</p>
<pre><code>module load cray-stat
</code></pre>
<p>and view the merged stack trace using:</p>
<pre><code>stat-view atpMergedBT.dot
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To see the graph, you will need to have exported your X display when
logging in.</p>
</div>


  




                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/ARCHER2-HPC" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/ARCHER2_HPC" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/groups/13848871/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["tabs"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.b4d07000.min.js"></script>
      
    
  </body>
</html>